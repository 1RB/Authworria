<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <script
      src="https://kit.fontawesome.com/1788c719dd.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <script src="js/app.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script>
        document.addEventListener("deviceready", onDeviceReady, false); // user is on mobile, set up a notification
    </script>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/app.css" />
    <title>authchat</title>
  </head>

  <body>
    <div
      id="coverbg"
      style="
        position: fixed;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        z-index: 99999;
        overflow: hidden;
        background-color: rgba(0, 0, 0, 0.7);
        transition: visibility 0s ease 0s, opacity 0.125s linear 0s;
        visibility: hidden;
        opacity: 0;
      "
    ></div>
    <script
      src="https://cdn.socket.io/4.4.0/socket.io.min.js"
      integrity="sha384-1fOn6VtTq3PWwfsOrk45LnYcGosJwzMHv+Xh/Jx5303FVOXzEnw0EpLv30mtjmlj"
      crossorigin="anonymous"
    ></script>
    <div data-tf-popover="dRWNEeLp" data-tf-button-color="#D65C99" data-tf-tooltip="Do you mind spending 2 minutes to give feedback " data-tf-open="load" data-tf-chat data-tf-medium="snippet" style="all:unset;"></div><script src="//embed.typeform.com/next/embed.js"></script>
    <!-- type="module" -->
    <script>
      let socket = null;
      let mySocketId = null;
      let resetUponUpdate = false;
      let pendingMessages = [];
      let sendNotif = null;
      let eHS = null;
      let aS = null;
      let smth = {};
      let known = {
        users: {},
        servers: {},
      };
      let doneFirstCheck = false;
    </script>
    <script>
      //on window load
      window.onload = () => {
        (async () => {
            let MUOSU = null
          let sS = null;
          let inHome = false;
          smth.getCanvasFontSize = getCanvasFontSize;
          smth.getCssStyle = getCssStyle;
          smth.customgetCssStyle = customgetCssStyle;
          smth.getCanvasFontSize = getCanvasFontSize;
          smth.getTextWidth = getTextWidth;

          eHS = exithomeScreen;
          aS = addServer;
          sendNotif = sendNotificaiton;
          let currentUser = {};
          const badgeResolver = {
            CAD: {
              name: "Certified Authworria Developer",
              short: "CAD",
              img: "/webchat-imgs/CAD.png",
            },
            AS: {
              name: "Authworria Staff",
              short: "AS",
              img: "/webchat-imgs/AS.svg",
            },
          };

          function setIdleTimer() {
            let previousStatus = null;
            var time;
            document.onload = resetTimer;
            document.onmousemove = resetTimer;
            document.onmousedown = resetTimer; // touchscreen presses
            document.ontouchstart = resetTimer;
            document.onclick = resetTimer; // touchpad clicks
            document.onkeydown = resetTimer; // onkeypress is deprectaed
            document.addEventListener("scroll", resetTimer, true); // improved; see comments

            function setIdle() {
              if (currentUser.status == "online") {
                console.log("User set to idle due to inactivity");
                previousStatus = "online";
                socket.emit("changeStatus", {
                  status: "idle",
                  token: firebase?.auth()?.currentUser?.xa,
                  storeindb: false,
                });
                // currentUser.status = "idle";
              }
            }

            function resetTimer() {
              if (previousStatus) {
                console.log(
                  "User has returned from idle. Setting status to " +
                    previousStatus.toUpperCase()
                );
                socket.emit("changeStatus", {
                  token: firebase?.auth()?.currentUser?.xa,
                  status: previousStatus,
                });
                // currentUser.status = previousStatus;
                previousStatus = null;
              }
              clearTimeout(time);
              time = setTimeout(setIdle, 300000);
            }
          }

          setIdleTimer();
          document.body.addEventListener("click", (e) => {
            if (document.getElementsByName("user-menu")) {
              // remove all user-menu's when clicked outside
              if (!e.target.closest("[name=user-menu]")) {
                document.getElementsByName("user-menu").forEach((el) => {
                  el.remove();
                });
              }
            }
            if (document.getElementsByName("server-menu")) {
              // remove all user-menu's when clicked outside
              if (!e.target.closest("[name=server-menu]")) {
                document.getElementsByName("server-menu").forEach((el) => {
                  el.remove();
                });
              }
            }
          });
          let amountOfFriends = 0;
          let amountOfServers = 0;

          // import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-analytics.js";

          const firebaseConfig = {
            apiKey: "AIzaSyBXksQoBsWZkS8Dw_P90mb9BP-wt9XaMrg", //<- lemfao
            authDomain: "authworria.com",
            databaseURL:
              "https://authworria-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "authworria",
            storageBucket: "authworria.appspot.com",
            messagingSenderId: "635623599897",
            appId: "1:635623599897:web:0ee18f2824aa3b764e5f88",
            measurementId: "G-P84R1SCWJB",
          };
          async function addServer(data) {
            known.servers[data.serverID] = data;
            amountOfServers++;
            let server = document.createElement("div");
            server.id = "server-" + known.servers[data.serverID].serverID;
            server.style.borderRadius = "10vh";
            server.style.display = "flex";
            server.style.justifyContent = "center";
            server.style.width = "100%";
            server.style.marginBottom = "10px";
            server.style.height = "100%";
            server.style.alignItems = "center";
            let serverImg = document.createElement("img");
            serverImg.style.width = "48px";
            serverImg.style.height = "48px";
            serverImg.style.borderRadius = "10vh";
            serverImg.style.transition = "border-radius 0.125s, ease 0.125s";
            serverImg.id =
              "server-img-" + known.servers[data.serverID].serverID;
            serverImg.src = known.servers[data.serverID].serverPicture;
            let serverSidebar = document.createElement("div");
            serverSidebar.style.width = "4px";
            serverSidebar.style.height = "4px";
            serverSidebar.style.backgroundColor = "white";
            serverSidebar.style.left = "2px";
            serverSidebar.style.position = "absolute";
            serverSidebar.style.borderRadius = "10vh";
            serverSidebar.style.transition = "height 0.125s, ease 0.125s";
            serverSidebar.id =
              "server-sidebar-" + known.servers[data.serverID].serverID;
            server.addEventListener("contextmenu", (e) => {
              e.preventDefault();
              /*

    <div id="server-menu">
      <ul id="menu-options">
        <li id="menu-option">a</li>
        <li id="menu-option">b</li>
        <li id="menu-option">c</li>
        <li id="menu-option">d</li>
      </ul>
    </div>

        <style>
      #server-menu {
        width: 120px;
        box-shadow: 0 4px 5px 3px rgba(0, 0, 0, 0.2);
        position: relative;
      }
      #menu-options {
        list-style: none;
        padding: 10px 0;
      }
      #menu-option {
        font-weight: 500;
        font-size: 14px;
        padding: 10px 40px 10px 20px;
        cursor: pointer;
      }
      #menu-option:hover {
        background: rgba(0, 0, 0, 0.2);
      }
    </style>
                
                */
              document.getElementsByName("server-menu").forEach((el) => {
                el.remove();
              });
              let serverMenu = document.createElement("div");
              serverMenu.id = "server-menu";
              serverMenu.setAttribute("name", "server-menu");
              serverMenu.style.left = e.clientX + "px";
              serverMenu.style.top = e.clientY + "px";
              serverMenu.style.position = "relative";
              serverMenu.style.width = "120px";
              serverMenu.style.backgroundColor = "#FFF";
              serverMenu.style.boxShadow = "0 4px 5px 3px rgba(0, 0, 0, 0.2)";
              serverMenu.style.zIndex = "9999";
              let menuOptions = document.createElement("ul");
              menuOptions.id = "menu-options";
              menuOptions.style.listStyle = "none";
              menuOptions.style.padding = "10px 0";
              let menuOption1 = document.createElement("li");
              menuOption1.id = "menu-option";
              menuOption1.innerHTML = "a";
              menuOption1.style.fontWeight = "500";
              menuOption1.style.fontSize = "14px";
              menuOption1.style.padding = "10px 0px 10px 0px";
              menuOption1.style.cursor = "pointer";
              menuOption1.style.textAlign = "center";
              menuOption1.onmouseover = () => {
                menuOption1.style.background = "rgba(0, 0, 0, 0.2)";
              };
              menuOption1.onmouseout = () => {
                menuOption1.style.background = "";
              };
              let menuOption2 = document.createElement("li");
              menuOption2.id = "menu-option";
              menuOption2.innerHTML = "b";
              menuOption2.style.fontWeight = "500";
              menuOption2.style.fontSize = "14px";
              menuOption2.style.padding = "10px 0px 10px 0px";
              menuOption2.style.cursor = "pointer";
              menuOption2.style.textAlign = "center";
              menuOption2.onmouseover = () => {
                menuOption2.style.background = "rgba(0, 0, 0, 0.2)";
              };
              menuOption2.onmouseout = () => {
                menuOption2.style.background = "";
              };
              let menuOption3 = document.createElement("li");
              menuOption3.id = "menu-option";
              menuOption3.innerHTML = "c";
              menuOption3.style.fontWeight = "500";
              menuOption3.style.fontSize = "14px";
              menuOption3.style.padding = "10px 0px 10px 0px";
              menuOption3.style.cursor = "pointer";
              menuOption3.style.textAlign = "center";
              menuOption3.onmouseover = () => {
                menuOption3.style.background = "rgba(0, 0, 0, 0.2)";
              };
              menuOption3.onmouseout = () => {
                menuOption3.style.background = "";
              };
              let menuOption4 = document.createElement("li");
              menuOption4.id = "menu-option";
              menuOption4.innerHTML = "d";
              menuOption4.style.fontWeight = "500";
              menuOption4.style.fontSize = "14px";
              menuOption4.style.padding = "10px 0px 10px 0px";
              menuOption4.style.cursor = "pointer";
              menuOption4.style.textAlign = "center";
              menuOption4.onmouseover = () => {
                menuOption4.style.background = "rgba(0, 0, 0, 0.2)";
              };
              menuOption4.onmouseout = () => {
                menuOption4.style.background = "";
              };

              menuOptions.appendChild(menuOption1);
              menuOptions.appendChild(menuOption2);
              menuOptions.appendChild(menuOption3);
              menuOptions.appendChild(menuOption4);
              serverMenu.appendChild(menuOptions);
              document.body.appendChild(serverMenu);
            });
            server.appendChild(serverImg);
            server.appendChild(serverSidebar);
            document.getElementById("mainServers").appendChild(server);
            $("#server-" + known.servers[data.serverID].serverID).hover(
              function () {
                $(this)
                  .children(
                    "#server-img-" + known.servers[data.serverID].serverID
                  )
                  .css("border-radius", "14px");
                $(this)
                  .children(
                    "#server-sidebar-" + known.servers[data.serverID].serverID
                  )
                  .css("height", "30px");
                $(this).css("cursor", "pointer");
              },
              function () {
                $(this)
                  .children(
                    "#server-img-" + known.servers[data.serverID].serverID
                  )
                  .css("border-radius", "10vh");
                $(this)
                  .children(
                    "#server-sidebar-" + known.servers[data.serverID].serverID
                  )
                  .css("height", "4px");
                $(this).css("cursor", "default");
              }
            );
            $("#server-" + known.servers[data.serverID].serverID).click(() => {
              sS(known.servers[data.serverID]);
            });
          }
          async function addUser(data) {
            known.users[data.uid] = data;
            amountOfFriends++;
            let userdiv = document.createElement("div");
            userdiv.id = "user-" + known.users[data.uid].uid;
            userdiv.classList.add("user");
            userdiv.classList.add("changeonhover");
            userdiv.addEventListener(
              "contextmenu",
              async function (ev) {
                if (!ev.isTrusted) {
                  return;
                }
                ev.preventDefault();
                if (!ev.clientX || !ev.clientY) {
                  return false;
                }
                document.getElementsByName("user-menu").forEach((el) => {
                  el.remove();
                });
                // create a new div at the mouse position
                let div = document.createElement("div");
                // make the div at mouse pos
                div.style.left = ev.clientX + "px";
                div.style.top = ev.clientY + "px";
                div.setAttribute("name", "user-menu");
                //make the div have rounded corners and make the div 200x600 px
                div.style.borderRadius = "10px";
                div.style.width = "200px";
                div.style.height = "600px";
                div.style.backgroundColor = "#292b30";
                //border
                div.style.border = "1px solid #000";
                //remove element on blur
                div.addEventListener("blur", function () {
                  div.remove();
                });
                //z index of 20
                div.style.zIndex = "20";
                //position absolute
                div.style.position = "relative";

                div = await generateUserMenu(div, known.users[data.uid]);

                //attach the div to the body
                document.body.appendChild(div);

                return false;
              },
              false
            );
            let friendpfp = document.createElement("div");
            friendpfp.id = "friend-pfp-" + known.users[data.uid].uid;
            friendpfp.classList.add("friend-pfp");
            let friendpfpimg = document.createElement("img");
            friendpfpimg.referrerPolicy = "no-referrer";
            friendpfpimg.src = known.users[data.uid].avatar;
            friendpfpimg.classList.add("pfp-pic");
            friendpfpimg.id = "friendpfp-" + known.users[data.uid].uid;
            let friendtransparentOutline = document.createElement("div");
            friendtransparentOutline.id =
              "friend-transparentOutline-" + known.users[data.uid].uid;
            friendtransparentOutline.classList.add("transparentOutline");
            friendtransparentOutline.style.display = "block";
            friendtransparentOutline.style.position = "absolute";
            friendtransparentOutline.style.top = "27px";
            friendtransparentOutline.style.left = "28px";
            let friendstatus = document.createElement("img");
            friendstatus.id = "friend-statusicon-" + known.users[data.uid].uid;
            friendstatus.src = known.users[data.uid].statusIcon;
            friendstatus.classList.add("status-pfp");
            friendstatus.style.position = "absolute";
            friendstatus.style.top = "24px";
            friendstatus.style.left = "22px";
            let friendname = document.createElement("p");
            friendname.id = "friend-name-" + known.users[data.uid].uid;
            friendname.classList.add("friend-name");
            friendname.style.top = "-9px";
            friendname.style.left = "65px";
            friendname.innerHTML = known.users[data.uid].name; // change to username later
            let friendstatusp = document.createElement("p");
            friendstatusp.id = "friend-status-" + known.users[data.uid].uid;
            friendstatusp.classList.add("friend-status");
            friendstatusp.style.top = "13px";
            friendstatusp.style.left = "65px";
            // sus
            if (
              getTextWidth(
                known.users[data.uid].status,
                getCanvasFontSize(friendstatusp)
              ) >
              245 - 9
            ) {
              // if the status is too long, shorten it until its less than 200 pixels minus the size of "..." (9 px) and add ...
              let status = known.users[data.uid].status;
              while (
                getTextWidth(status, getCanvasFontSize(friendstatusp)) >
                245 - 9
              ) {
                status = status.substring(0, status.length - 1);
              }
              friendstatusp.innerText = status + "...";
            } else {
              friendstatusp.innerText = known.users[data.uid].status;
            }
            friendpfp.appendChild(friendpfpimg);
            friendpfp.appendChild(friendtransparentOutline);
            friendpfp.appendChild(friendstatus);
            userdiv.appendChild(friendpfp);
            userdiv.appendChild(friendname);
            userdiv.appendChild(friendstatusp);
            document.getElementById("friend-list").appendChild(userdiv);
          }
          let app;
          if (firebase.apps.length) {
            app = firebase.app();
          } else {
            app = await firebase.initializeApp(firebaseConfig);
          }
          let serverLastUpdate = null;
          let serverUpdateTimer = null;
          $(window).unload(function () {
            socket.disconnect(); // Disconnects the user when the page is being closed
          });
          async function launchSocket() {
            socket.on("connect", async function () {
              console.log("Connected, my socket id: %s", socket.id);
              mySocketId = socket.id;
              await firebase.auth().currentUser.getIdToken(true); //make sure token is refreshed
              socket.emit("userIdent", {
                // Identifies the user to the server using firebases token
                token: firebase?.auth()?.currentUser?.xa,
              });
              if (window.plugins.OneSignal) {
                updateUserID();
              }
              //
            });
            socket.on("getInfoProfRes", async function (data) {
              if (data.err) return;
            })
            socket.on("removeKnownRes", async function (data) {
              // Remove the uid user from the friend list (element has id "user-<uid>")
              document.getElementById("user-" + data.uid).remove();
              amountOfFriends--;
              // TODO: Update the friend list
              await updateFriendList();
            });
            socket.on("changeServerImageRes", function (data) {
              if (data.err) return;
              if (data.img) {
                document.getElementById("server-img-" + data.server).src =
                  data.img;
              }
            });
            socket.on("userIdentRes", function (data) {
              // Executes when the server responds to the client indentification request
              // Returns: {err: "<error message>"} if failed. Otherwise, returns {success: true, user: {uid: <users uid>, username: <username>, email: <email>, avatar: <avatar url>, status: <status>, statusImg: <status image url>}}
              if (data.err == "Token expired") {
                socket.disconnect(); // Disconnects the user when the token is expired
                window.location.href = "./login.html"; // Redirects the user to the login page
              }
              console.log("UserIdent sent, response:", data);
              currentUser = data.user;
              socket.emit("getStatus", {
                imgloc: "/webchat-imgs/",
                token: firebase?.auth()?.currentUser?.xa,
              }); // Requests the status of the user
              checkUpdateStart(); // Starts the update checker
              socket.emit("getKnown", {
                token: firebase?.auth()?.currentUser?.xa,
              });
              socket.emit("getKnownServers", {
                token: firebase?.auth()?.currentUser?.xa,
              });
            });
            function checkUpdateStart() {
              socket.emit("lastUpdate");
              serverUpdateTimer = setInterval(() => {
                if (!document.hidden && resetUponUpdate) {
                  socket.emit("lastUpdate");
                }
              }, 30000);
            }
            socket.on("getMessagesRes", async function (data) {
              if (data.err) return console.log(data.err);
              addMessages(data.messages);
            });
            async function addMessages(messages) {
              let messageList = document.getElementById("messageList");
              // sort messages by time, the time is located in each element of the array which is an object.
              messages.sort((a, b) => {
                return a.time - b.time;
              });
              for (let message of Object.keys(messages)) {
                let msgObject = messages[message];
              }
            }
            socket.on("getKnownServersRes", function (data) {
              if (data.err) return console.log(err);
              console.log("getKnownServers sent. Response: ", data);
              if (data.servers.length > 0) {
                socket.emit("getBulk", {
                  token: firebase.auth().currentUser.xa,
                  ids: data.servers,
                  type: "servers",
                });
              } else {
                console.log("No servers found");
              }
            });
            socket.on("lastUpdateRes", function (data) {
              if (!serverLastUpdate) {
                serverLastUpdate = data.lastUpdateTime;
              }
              if (serverLastUpdate != data.lastUpdateTime && resetUponUpdate) {
                console.log("Update from server:", data);
                clearInterval(serverUpdateTimer);
                socket.disconnect();
                return window.location.reload(true);
              }
            });
            socket.on("getInfoProfRes", async function (data) {
              if (data.err) return;
              let profile = await generateProfile(data);
              document.body.appendChild(profile);
              document.getElementById(
                "profile-view-" + data.uid
              ).style.visibility = "visible";
              document.getElementById(
                "profile-view-" + data.uid
              ).style.opacity = "1";
            });
            socket.on("disconnect", function () {
              // Executes when the client disconnects from the server
              // Returns: nothing.
              clearInterval(serverUpdateTimer);
              console.log("Disconnected");
            });
            socket.on("changeStatusRes", function (data) {
              // Executes when the server responds to clients request to change status
              // Returns: {err: "<errormsg>"} if fails else returns {success: true, status: <new status>, statusImg: <status image location>}
              if (data.err) return;
              if (currentUser.status !== data.status) {
                document.getElementById("userstatuspfp").src = data.statusImg;
                document.getElementById("userstatus").src = data.statusImg;
              }
              console.log("Status changed to:", data.statusText);
              if (
                getTextWidth(
                  data.status,
                  getCanvasFontSize(document.getElementById("profile-status"))
                ) >
                200 - 9
              ) {
                console.log("Status too long, trimming...");
                // if the status is too long, shorten it until its less than 200 pixels minus the size of "..." (9 px) and add ...
                let status = data.statusText;
                while (
                  getTextWidth(
                    status,
                    getCanvasFontSize(document.getElementById("profile-status"))
                  ) >
                  200 - 9
                ) {
                  status = status.substring(0, status.length - 1);
                }
                document.getElementById("profile-status").innerText =
                  status + "...";
                console.log(
                  "Status trimmed to: " +
                    status +
                    "... with a width of: " +
                    getTextWidth(
                      status + "...",
                      getCanvasFontSize(
                        document.getElementById("profile-status")
                      )
                    ) +
                    "px"
                );
              } else {
                document.getElementById("profile-status").innerText =
                  data.statusText;
                console.log(
                  "Status didn't need to be trimmed, it's width is: %s",
                  getTextWidth(
                    data.statusText,
                    getCanvasFontSize(document.getElementById("profile-status"))
                  )
                );
              }
              currentUser.status = data.status;
            });
            socket.on("usrChangeInfo", function (data) {
              // Executes when a user changes their status.
              // Returns: {uid: <user uid>, statusText: <status text>, status: <new status>, statusImg: <status image location>}
              let statusText = data.statusText || "";
              if (document.getElementById("friend-statusicon-" + data.uid)) {
                if (
                  document.getElementById("friend-statusicon-" + data.uid)
                    .src !== data.statusImg
                ) {
                  document.getElementById("friend-statusicon-" + data.uid).src =
                    data.statusImg;
                }
                if (
                  getTextWidth(
                    data.status,
                    getCanvasFontSize(
                      document.getElementById("friend-status-" + data.uid)
                    )
                  ) >
                  250 - 9
                ) {
                  console.log("Status too long, trimming...");
                  // if the status is too long, shorten it until its less than 200 pixels minus the size of "..." (9 px) and add ...
                  let status = statusText;
                  while (
                    getTextWidth(
                      status,
                      getCanvasFontSize(
                        document.getElementById("friend-status-" + data.uid)
                      )
                    ) >
                    250 - 9
                  ) {
                    status = status.substring(0, status.length - 1);
                  }
                  statusText = status + "...";
                  console.log(
                    "Status trimmed to: " +
                      status +
                      "... with a width of: " +
                      getTextWidth(
                        status + "...",
                        getCanvasFontSize(
                          document.getElementById("friend-status-" + data.uid)
                        )
                      ) +
                      "px"
                  );
                }
                document.getElementById("friend-status-" + data.uid).innerHTML =
                  escapeString(statusText);
              }
              if (document.getElementById("profile-view-" + data.uid)) {
                updateProfile(data);
              }
            });
            socket.on("getStatusRes", function (data) {
              // Executes when the server reponds to a client request to get the status of a user
              // Returns: {err: "<errormsg>"} if fails else returns {uid: <user uid>, status: <user status>, success: true, statusImg: <status image location>}
              document.getElementById("userstatuspfp").src = data.statusImg;
              document.getElementById("userstatus").src = data.statusImg;
              document.getElementById("transparentOutline").style.display =
                "block";
              let userstatusp = document.getElementById("profile-status");

              if (
                getTextWidth(data.statusText, getCanvasFontSize(userstatusp)) >
                200 - 9
              ) {
                console.log("Status too long, trimming...");
                // if the status is too long, shorten it until its less than 200 pixels minus the size of "..." (9 px) and add ...
                let status = data.statusText;
                while (
                  getTextWidth(status, getCanvasFontSize(userstatusp)) >
                  200 - 9
                ) {
                  status = status.substring(0, status.length - 1);
                }
                userstatusp.innerText = status + "...";
                console.log(
                  "Status trimmed to: " +
                    status +
                    "... with a width of: " +
                    getTextWidth(
                      status + "...",
                      getCanvasFontSize(userstatusp)
                    ) +
                    "px"
                );
              } else {
                userstatusp.innerText = data.statusText;
              }
            });
            socket.on("getInfoRes", function (data) {
              //   // check if uid matches our uid, if so return
              //   if (data.err) {
              //     console.log("Error:", data.err);
              //     return;
              //   }
              //   if (data.uid == currentUser.uid) return;
              //   // if not, check if uid is in friend list, if so return
              //   if (document.getElementById("friend-pfp-" + data.uid))
              //     return console.log(
              //       "User: " + data.uid + " is already in friend list"
              //     );
              //   // add user to friend list using addUser function with the data variable passed in
              //   addUser(data);
              //   console.log("User added:", data.uid + " (" + data.name + ")");
            });
            socket.on("getBulkRes", function (data) {
              if (data.err) {
                console.log("Error:", data.err);
                return;
              }
              if (data.type == "users") {
                for (let userData of data?.results) {
                  if (userData.err === "User does not exist") {
                    console.log(
                      "According to SERVER, user " +
                        userData.uid +
                        " does not exist"
                    );
                    continue;
                  }
                  if (userData.uid == currentUser.uid) continue;
                  // if not, check if uid is in friend list, if so return
                  if (document.getElementById("friend-pfp-" + userData.uid)) {
                    console.log(
                      "User: " + userData.uid + " is already in friend list"
                    );
                    continue;
                  }
                  addUser(userData);
                  console.log(
                    "User added:",
                    userData.uid + " (" + userData.name + ")"
                  );
                }
              } else if (data.type == "servers") {
                for (let serverData of data?.results) {
                  if (serverData.err === "Server does not exist") {
                    console.log(
                      "According to SERVER, server " +
                        serverData.serverID +
                        " does not exist"
                    );
                    continue;
                  }
                  // if not, check if uid is in friend list, if so return
                  if (
                    document.getElementById("server-" + serverData.serverID)
                  ) {
                    console.log(
                      "Server: " +
                        serverData.serverID +
                        " is already in server list"
                    );
                    continue;
                  }
                  addServer(serverData);
                  console.log(
                    "Server added:",
                    serverData.serverID + " (" + serverData.name + ")"
                  );
                }
              } else if (data.type == "codes") {
              }
            });
            socket.on("getKnownRes", async function (data) {
              // Executes when the server requests the list of known users
              // Returns: {err: "<errormsg>"} if fails else returns {uid:<user uid>, knownUsers:[<friend uid 1>, <friend uid 2>, ...]}
              console.log("getKnown sent, response:", data);
              if (data.err) {
                console.log("Error:", data.err);
              } else {
                let known = data.knownUsers.sort();
                console.log("Known users:", known, ". Requesting info...");
                socket.emit("getBulk", {
                  token: firebase?.auth()?.currentUser?.xa,
                  type: "users",
                  ids: known,
                });
              }
            });
            socket.on("updateAbtMeRes", function (data) {
              // Executes when the server responds to a client request to update the user's about me
              // Returns: {err: "<errormsg>"} if fails else returns {uid: <user uid>, aboutMe: <new about me>}
              if (data.err) {
                console.log("Error:", data.err);
              } else {
                console.log("About me updated to:", data.aboutme);
                currentUser.aboutMe = data.aboutme;
              }
            });
            socket.on("sendMessageRes", function (data) {
              // Executes when the server responds to a client request to send a message
              // Returns: {err: "<errormsg>"} if fails else returns {success: true, message: <message>, sender: <sender>, senderUID: <senders UID>, senderImg: <senders pfp>, time: <time>}
              if (data.err) return console.log(data.err);
              try {
                console.log("Message sent:", data);
                document
                  .getElementById("temp-msg-" + data.elementcode)
                  .removeAttribute("class");
                let lastMessage = document.getElementsByName("latest-msg")[0];
                for (let i of document.getElementsByName("latest-msg")) {
                  i.removeAttribute("name");
                }
                document
                  .getElementById("temp-msg-" + data.elementcode)
                  .setAttribute("name", "latest-msg");
                if (
                  lastMessage &&
                  lastMessage?.dataset?.sender === data?.senderUID
                ) {
                  // data.time
                  const time = new Date(data.time);
                  const timeString = time.toLocaleTimeString([], {
                    hour: "2-digit",
                    minute: "2-digit",
                  });

                  // last message is from current user
                  document.getElementById(
                    "temp-msg-" + data.elementcode
                  ).innerHTML =
                    "<div class='timebox' id='sender-pfp-" +
                    data.messageID +
                    "'>" +
                    timeString +
                    "</div>" +
                    "<p id='aftermsg'>" +
                    data.message +
                    "</p>";
                  // css for sender pfp
                  document.getElementById(
                    "sender-pfp-" + data.messageID
                  ).style.cssText =
                    "border-radius: 50%; " +
                    "display: inline-flex; " +
                    "align-items: center; " +
                    "font-size: 10px; " +
                    "text-align: center;" +
                    "justify-content: center; " +
                    "margin: 3.5px;" +
                    "min-width: fit-content;" +
                    "margin-right: 10px;";

                  // if an element has the attribute latest-msg also add the attribute no-pfp-msg
                } else {
                  // last message is from another user or no last message
                  document.getElementById(
                    "temp-msg-" + data.elementcode
                  ).innerHTML =
                    "<img id='sender-pfp-" +
                    data.messageID +
                    "'>" +
                    "<p id='usrname'><u><b>" +
                    data.sender +
                    "</b></u>" +
                    "<br> " +
                    data.message +
                    "</p>";
                  document.getElementById("sender-pfp-" + data.messageID).src =
                    data.senderImg;
                }

                document.getElementById(
                  "temp-msg-" + data.elementcode
                ).dataset.time = data.time;
                document.getElementById(
                  "temp-msg-" + data.elementcode
                ).dataset.sender = data.senderUID;
                document.getElementById("temp-msg-" + data.elementcode).id =
                  "message-" + data.messageID;
              } catch (e) {
                console.error("Error in sendMessageRes:", e);
              }
            });
            socket.on("receiveMessage", function (data) {
              // Executes when the client receives a message
              // Returns: {message: <message>, sender: <sender>, senderUID: <senders UID> senderImg: <senders pfp>, time: <time>}
              let lastMessage = document.getElementsByName("latest-msg")[0];
              console.log(lastMessage);
              for (let i of document.getElementsByName("latest-msg")) {
                i.removeAttribute("name");
              }
              if (
                lastMessage &&
                lastMessage?.dataset?.sender === data?.senderUID
              ) {
                // last message is from the same user
                document.getElementById("messageList").innerHTML +=
                  "<li id='message-" +
                  data.messageId +
                  "'>" +
                  "<p id=usrname>" +
                  data.message +
                  "</p>" +
                  "</li>";
              } else {
                // last message is from another user or no last message
                document.getElementById("messageList").innerHTML +=
                  "<li id='message-" +
                  data.messageId +
                  "'>" +
                  "<img id='sender-pfp-" +
                  data.messageId +
                  "'>" +
                  "<p id='usrname'><u><b>" +
                  escapeString(data.sender) +
                  "</b></u>" +
                  "<br> " +
                  data.message +
                  "</p>" +
                  "</li>";
                document.getElementById("sender-pfp-" + data.messageId).src =
                  data.senderImg;
              }
              document
                .getElementById("message-" + data.messageId)
                .setAttribute("name", "latest-msg");
              document.getElementById(
                "message-" + data.messageId
              ).dataset.time = data.time;
              document.getElementById(
                "message-" + data.messageId
              ).dataset.sender = data.senderUID;

              document.getElementById("messageList").innerHTML += "<br> ";
              //scroll
              document.getElementById("messageList").scrollTop =
                document.getElementById("messageList").scrollHeight;
            });
            socket.on("getMessagesRes", function (data) {
              // Executes when the server responds to a client request to get messages in a certain limit
              // Returns: {err: "<errormsg>"} if fails else returns {success: true, messages: [{message: <message>, sender: <sender>, senderImg: <senders pfp>, time: <time>}, ...]}
            });
          }

          let failedConnections = 0;
          // check if the user is logged in
          firebase.auth().onAuthStateChanged(async function (user) {
            if (user) {
              // User is signed in.
              firebase.auth().currentUser.getIdToken(true); //make sure token is refreshed
              socket = await io("https://ws.inimicalpart.com:4242"); // ws.inimicalpart.com:4242
              // prettier-ignore
              socket.on("connect_error",e=>{console.log("failed to connect to server"),failedConnections++,3==failedConnections&&(console.log("failed to connect to server 3 times"),Swal.fire({title:"Failed to connect to server",text:"The server hasn't responded in 3 retries. Waiting until connection is made...",icon:"error",background:"#292b30",customClass:{title:"whiteTextTitle",htmlContainer:"grayTextTitle"},showCloseButton:!1,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1}),socket.on("connect",()=>{console.log("connected to server"),failedConnections=0,Swal.close()}))}),socket.on("connect_failed",e=>{console.log("failed to connect to server"),failedConnections++,3==failedConnections&&(console.log("failed to connect to server 3 times"),Swal.fire({title:"Failed to connect to server",text:"The server hasn't responded in 3 retries. Waiting until connection is made...",icon:"error",background:"#292b30",customClass:{title:"whiteTextTitle",htmlContainer:"grayTextTitle"},showCloseButton:!1,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1}),socket.on("connect",()=>{console.log("connected to server"),failedConnections=0,Swal.close()}))});

              await showUserDetail(user);
              await launchSocket();
              await setupServers();
              await continueSetup();
              document.getElementById("loading").style.display = "none";
              document.getElementById("app").style.display = "block";
            } else {
              // No user is signed in.
              window.location.href = "./login.html";
            }
          });
          function getTextWidth(text, font) {
            // re-use canvas object for better performance
            const canvas =
              getTextWidth.canvas ||
              (getTextWidth.canvas = document.createElement("canvas"));
            const context = canvas.getContext("2d");
            context.font = font;
            const metrics = context.measureText(text);
            return metrics.width;
          }

          function getCssStyle(element, prop) {
            return window
              .getComputedStyle(element, null)
              .getPropertyValue(prop);
          }
          function customgetCssStyle(el, prop) {
            return el.style[prop];
          }
          function updateProfile(data) {
            console.log(data);
            document.getElementById("profile-status-" + data.uid).src =
              data.statusImg;
            let statustext = document.getElementById(
              "profile-status-text-" + data.uid
            );
            if (
              getTextWidth(
                data.statusText,
                customgetCanvasFontSize(statustext)
              ) > 531
            ) {
              //loop thru text and remove one character until its less than 531 pixels, then set the result to statustext.innerHTML with "..."
              let text = data.statusText;
              let textwidth = getTextWidth(
                text,
                customgetCanvasFontSize(statustext)
              );
              while (textwidth > 531) {
                text = text.substring(0, text.length - 1);
                textwidth = getTextWidth(
                  text,
                  customgetCanvasFontSize(statustext)
                );
              }
              statustext.innerHTML = text + "...";
            } else {
              statustext.innerHTML = data.statusText;
            }
            document.getElementById("profile-name-" + data.uid).innerHTML =
              data.username;
            document
              .getElementById("profile-banner-container-" + data.uid)
              .childNodes[0].remove();
            let banner;
            if (data.banner) {
              banner = document.createElement("img");
              banner.id = "profile-banner-" + data.uid;
              banner.src = data.banner;
              banner.style.width = "100%";
              banner.style.height = "130px";
              banner.style.borderRadius = "inherit";
            } else {
              banner = document.createElement("div");
              banner.style.width = "100%";
              banner.style.height = "130px";
              banner.style.borderRadius = "inherit";
              banner.style.backgroundColor = "#000";
            }
            document
              .getElementById("profile-banner-container-" + data.uid)
              .appendChild(banner);
            document.getElementById("profile-pfp-" + data.uid).src =
              data.avatar;
            try {
              if (document.getElementById("profile-aboutme-txt-" + data.uid))
                document
                  .getElementById("profile-aboutme-txt-" + data.uid)
                  ?.remove();
              if (document.getElementById("profile-aboutme-div-" + data.uid))
                document
                  .getElementById("profile-aboutme-div-" + data.uid)
                  ?.remove();
              if (document.getElementById("profile-aboutme-" + data.uid))
                document
                  .getElementById("profile-aboutme-" + data.uid)
                  ?.remove();
            } catch (error) {
              console.log(error);
            }
            console.log(data);
            if (data.aboutMe) {
              aboutme = document.createElement("p");
              aboutme.id = "profile-aboutme-txt-" + data.uid;
              aboutme.style.position = "relative";
              aboutme.style.top = "-30px";
              aboutme.style.left = "20px";
              aboutme.style.color = "#949494";
              aboutme.innerHTML = "About Me";
              //create aboutme div
              aboutmeDiv = document.createElement("div");
              aboutmeDiv.id = "profile-aboutme-div-" + data.uid;
              aboutmeDiv.style.position = "relative";
              aboutmeDiv.style.top = "-45px";
              aboutmeDiv.setAttribute("name", "aboutme");
              aboutmeDiv.style.width = "calc(100% - 40px)";
              aboutmeDiv.style.height = "auto";
              aboutmeDiv.style.marginLeft = "20px";
              aboutmeDiv.style.marginRight = "20px";
              aboutmeDiv.style.borderRadius = "8px";

              //create aboutme text
              aboutmeText = document.createElement("p");
              aboutmeText.id = "profile-aboutme-" + data.uid;

              aboutmeText.style.position = "inherit";
              aboutmeText.style.top = "5px";
              aboutmeText.style.fontSize = "14px";
              aboutmeText.style.color = "#ccc";
              aboutmeText.innerHTML = convertAbtMe(data.aboutMe);
              aboutmeDiv.appendChild(aboutmeText);
              document
                .getElementById("profile-view-" + data.uid)
                .appendChild(aboutmeDiv);
              document
                .getElementById("profile-view-" + data.uid)
                .appendChild(aboutme);
            }

            //friendcode
            document.getElementById(
              "profile-friendcode-" + data.uid
            ).innerHTML = "(" + data.friendCode + ")";
            //remove every child in badges
            document.getElementById("profile-badges-" + data.uid).innerHTML =
              "";
            //add badges
            let badgesimgs = data.badges || [];
            console.log(data);
            // loop through all the badges and give it to the badgeResolver function that will return the location of the image which will be under badgeResolver(badge).img
            for (let i = 0; i < badgesimgs.length; i++) {
              let badge = badgesimgs[i];
              let badgeimg = badgeResolver[badge];
              let badgeimgdiv = document.createElement("img");
              badgeimgdiv.src = badgeimg.img;
              badgeimgdiv.style.height = "inherit";
              if (
                document.getElementById("profile-badges-" + data.uid)
                  .childElementCount < 15
              ) {
                document
                  .getElementById("profile-badges-" + data.uid)
                  .appendChild(badgeimgdiv);
              }
            }
          }

          function getCanvasFontSize(el = document.body) {
            const fontWeight = getCssStyle(el, "font-weight") || "normal";
            const fontSize = getCssStyle(el, "font-size") || "16px";
            const fontFamily =
              getCssStyle(el, "font-family") || "Times New Roman";

            return `${fontWeight} ${fontSize} ${fontFamily}`;
          }
          function customgetCanvasFontSize(el = document.body) {
            const fontWeight = customgetCssStyle(el, "font-weight") || "normal";
            const fontSize = customgetCssStyle(el, "font-size") || "16px";
            const fontFamily =
              customgetCssStyle(el, "font-family") || "Times New Roman";

            return `${fontWeight} ${fontSize} ${fontFamily}`;
          }

          async function generateUserMenu(menudiv, data) {
            let remfriend = document.createElement("div");
            remfriend.id = "rem-friend";
            remfriend.style.position = "absolute";
            remfriend.style.bottom = "0";
            remfriend.style.width = "100%";
            remfriend.style.height = "40px";
            // remfriend.style.backgroundColor = "#ff3333";
            //display justify-content-center
            remfriend.style.display = "flex";
            remfriend.style.justifyContent = "center";
            remfriend.style.alignItems = "center";
            remfriend.style.marginBottom = "20px";
            //border should be a seperator line
            remfriend.style.border = "1px solid #ff3333";
            remfriend.style.transition = "all 0.5s ease-in-out";
            remfriend.style.cursor = "pointer";
            remfriend.dataset.uid = data.uid;

            //remfriend.style.borderRadius = "10px";

            //put <p> in it with the text "Remove friend" centered both horizontally and vertically with white color
            let remfriendp = document.createElement("p");
            remfriendp.style.textAlign = "center";
            remfriendp.style.margin = "auto";
            remfriendp.style.color = "red";
            remfriendp.style.transition = "all 0.5s ease-in-out";

            remfriendp.innerHTML = "Remove friend";
            remfriend.onmouseover = function () {
              remfriend.style.backgroundColor = "#dd3333";
              remfriendp.style.color = "white";
            };
            remfriend.onmouseout = function () {
              remfriend.style.backgroundColor = "";
              remfriendp.style.color = "red";
            };
            //on click or tap, remove friend from the list
            remfriend.onclick = function () {
              socket.emit("removeKnown", {
                knownUid: data.uid,
                token: firebase?.auth()?.currentUser?.xa,
              });
            };

            //new div with id "view-profile" that has the same properties as remfriend except for the margin-bottom, border and background color
            let viewprofile = document.createElement("div");
            viewprofile.id = "view-profile";
            viewprofile.style.position = "absolute";
            viewprofile.style.bottom = "top";
            viewprofile.style.width = "100%";
            viewprofile.style.height = "40px";
            // viewprofile.style.backgroundColor = "#33ff33";
            //display justify-content-center
            viewprofile.style.display = "flex";
            viewprofile.style.justifyContent = "center";
            viewprofile.style.alignItems = "center";
            viewprofile.style.marginTop = "20px";
            //border should be a seperator line
            viewprofile.style.border = "1px solid #000";
            viewprofile.dataset.uid = data.uid;
            viewprofile.onmouseover = function () {
              viewprofile.style.cursor = "pointer";
            };
            viewprofile.onmouseout = function () {
              viewprofile.style.cursor = "";
            };
            viewprofile.onclick = async function () {
              return alert("Under construction."); // TODO: remove this when finished
              document.getElementById("coverbg").style.visibility = "visible";
              document.getElementById("coverbg").style.opacity = "1";
              for (let i of document.getElementsByName("user-menu")) {
                i.remove();
              }
              socket.emit("getInfoProf", {
                uid: data.uid,
                token: firebase?.auth()?.currentUser?.xa,
              });
              //   document.getElementById("profile-view").style.visibility =
              //     "visible";
              //   document.getElementById("profile-view").style.opacity = "1";
            };

            let viewprofilep = document.createElement("p");
            viewprofilep.style.textAlign = "center";
            viewprofilep.style.margin = "auto";
            viewprofilep.style.color = "black";
            viewprofilep.style.transition = "all 0.5s ease-in-out";
            //text "View profile"
            viewprofilep.innerHTML = "View profile";
            // attach

            viewprofile.appendChild(viewprofilep);
            remfriend.appendChild(remfriendp);

            //on hover change background color of remfriend to #ff3333 and remfriendp text color to white in an animation
            menudiv.appendChild(viewprofile);
            menudiv.appendChild(remfriend);

            return menudiv;
          }
          //prettier-ignore
          async function generateProfile(e){console.log("data",e);let t=document.createElement("div");t.id="profile-view-"+e.uid,t.setAttribute("name","profile-view"),t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="600px",t.style.backgroundColor="#292b30",t.style.borderRadius="8px",t.style.overflow="hidden",t.style.zIndex="100000",t.style.visibility="hidden",t.style.opacity="0",t.style.transition="visibility 0s, opacity 0.125s linear",t.style.height="auto";let l=document.createElement("div");l.style.borderTopLeftRadius="8px",l.style.borderTopRightRadius="8px",l.style.position="relative";let i,s=document.createElement("div");s.id="profile-banner-container-"+e.uid,s.style.position="relative",s.style.height="130px",s.style.width="100%",s.style.borderRadius="inherit",e.banner?((i=document.createElement("img")).id="profile-banner-"+e.uid,i.src=e.banner,i.style.width="100%",i.style.height="130px",i.style.borderRadius="inherit"):((i=document.createElement("div")).style.width="100%",i.style.height="130px",i.style.borderRadius="inherit",i.style.backgroundColor="#000");let o=document.createElement("div");o.setAttribute("name","pfp");let n=document.createElement("div");n.style.zIndex="10",n.style.position="absolute",n.style.height="30px",n.style.left="89px",n.style.bottom="-38px",n.style.width="30px",n.style.backgroundColor="#292b30",n.style.borderRadius="10vh";let d=document.createElement("img");d.id="profile-pfp-"+e.uid,d.src=e.avatar,d.style.borderRadius="10vh",d.style.top="70px",d.style.left="20px",d.style.height="90px",d.style.width="90px",d.style.position="absolute",d.style.border="8px #292b30 solid";let a=document.createElement("img");a.src=e.statusIcon,a.id="profile-status-"+e.uid,a.style.zIndex="10",a.style.position="absolute",a.style.height="35px",a.style.left="75px",a.style.top="100%";let p=document.createElement("div");p.id="profile-badges-"+e.uid,p.style.position="absolute",p.style.height="30px",p.style.width="calc(100% - 150px)",p.style.left="133px",p.style.maxHeight="30px",p.style.maxWidth="calc(100% - 150px)",p.style.whiteSpace="nowrap",p.style.marginTop="5px";let r=e.badges||[];for(let e=0;e<r.length;e++){let t=r[e],l=badgeResolver[t],i=document.createElement("img");i.src=l.img,i.style.height="inherit",p.childElementCount<15&&p.appendChild(i)}let y=document.createElement("p");y.id="profile-name-"+e.uid,y.style.color="white",y.style.fontSize="18px",y.style.fontWeight="bold",y.style.position="relative",y.style.top="30px",y.style.left="20px",y.style.fontFamily="Poppins, sans-serif",y.innerHTML=e.name,console.log(parseFloat(getTextWidth(e.name,customgetCanvasFontSize(y)))+25+"px"),console.log(customgetCanvasFontSize(y));let u=document.createElement("p");u.id="profile-friendcode-"+e.uid,u.style.color="#959595",u.style.position="relative",u.style.top="-13px",console.log(e.name,y),u.style.left=parseFloat(getTextWidth(e.name,customgetCanvasFontSize(y)))+25+"px",console.log("("+e.friendCode+")"),u.innerHTML="("+e.friendCode+")";let c=document.createElement("p");if(c.id="profile-status-text-"+e.uid,c.style.position="relative",c.style.top="-30px",c.style.left="20px",c.style.color="#9a9a9a",getTextWidth(e.status,customgetCanvasFontSize(c))>531){let t=e.status,l=getTextWidth(t,customgetCanvasFontSize(c));for(;l>531;)t=t.substring(0,t.length-1),l=getTextWidth(t,customgetCanvasFontSize(c));c.innerHTML=t+"..."}else c.innerHTML=e.status;let h=null,m=null,x=null;return e.aboutMe&&((h=document.createElement("p")).id="profile-aboutme-txt-"+e.uid,h.style.position="relative",h.style.top="-30px",h.style.left="20px",h.style.color="#949494",h.innerHTML="About Me",(m=document.createElement("div")).id="profile-aboutme-div-"+e.uid,m.style.position="relative",m.style.top="-45px",m.setAttribute("name","aboutme"),m.style.width="calc(100% - 40px)",m.style.height="auto",m.style.marginLeft="20px",m.style.marginRight="20px",m.style.borderRadius="8px",(x=document.createElement("p")).id="profile-aboutme-"+e.uid,x.style.position="inherit",x.style.top="5px",x.style.fontSize="14px",x.style.color="#ccc",x.innerHTML=convertAbtMe(e.aboutMe)),t.appendChild(l),s.appendChild(i),l.appendChild(s),l.appendChild(o),o.appendChild(n),o.appendChild(d),o.appendChild(a),l.appendChild(p),t.appendChild(y),t.appendChild(u),t.appendChild(c),h&&m&&x&&(t.appendChild(h),t.appendChild(m),m.appendChild(x)),t}
          async function setupServers() {
            document
              .getElementById("home-btn")
              .addEventListener("click", function () {
                if (!inHome) {
                  $("#server-div").css(
                    "height",
                    parseInt($("#server-div").css("height").replace("px", "")) *
                      3 +
                      "px"
                  );
                  let removeHeight =
                    ($("#server-div").css("height").replace("px", "") / 3) * 2;
                  $("#friend-list").css("top", removeHeight + 63 + "px");
                  $("#chat").css("visibility", "hidden");
                  inHome = true;
                }
              });
          }
          function exithomeScreen() {
            $("#server-div").removeAttr("style");
            $("#friend-list").removeAttr("style");
            $("#chat").css("visibility", "visible");

            inHome = false;
          }
          function convertAbtMe(text) {
            // there are atleast 2 of **s in text
            while (text.includes("**") && text.split("**").length > 1) {
              text = text.replace("**", "<br>").replace("**", "<br>");
            }
            text = text.replace("\n", "<br>");
            return text;
          }
          async function showUserDetail(user) {
            document.getElementById("profile-img").innerHTML += `
          <img id="pfp" referrerpolicy="no-referrer" src=${user.photoURL}></img>
          `;
            document.getElementById("profile-username").innerHTML += `
          <span id="username"><b>${escapeString(user.displayName)}</b></span>
          `;
          }
          function sendNotificaiton(author, message, authorimg) {
            if (/electron/i.test(navigator.userAgent)) {
              if (window.notificationHandler?.send) {
                window.notificationHandler.send(author, {
                  msg: message,
                  img: authorimg,
                });
              }
            }
          }
          function escapeString(str) {
            // escape string for html
            return str
              .replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#039;");
          }
          async function continueSetup() {
            document
              .getElementById("messageBox")
              .addEventListener("keyup", function (event) {
                if (event.keyCode === 13) {
                  event.preventDefault();
                  sendMessage();
                }
              });
            function escapeString(str) {
              // escape string for html
              return str
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
            }

            function makeID(length) {
              var result = "";
              var characters = "0123456789";
              var charactersLength = characters.length;
              for (var i = 0; i < length; i++) {
                result += characters.charAt(
                  Math.floor(Math.random() * charactersLength)
                );
              }
              return result;
            }
            function getServer() {
              var server = currentUser.focusedServer;
              return server;
            }
            sS = setServer;
            pSI = parseServerImage;
            function parseServerImage() {
              const reader = new FileReader();
              reader.onload = function () {
                const bytes = new Uint8Array(this.result);
                socket.emit("changeServerImage", {
                  server: currentUser.focusedServer.serverID,
                  token: firebase.auth().currentUser.xa,
                  image: bytes,
                });
              };
              reader.readAsArrayBuffer(
                document.getElementById("srvImg-chg").files[0]
              );
            }
            function setServer(server) {
              //get the name variable of the ol with id messageList
              var messageList = document.getElementById("messageList");
              //get the name variable of the ol with id messageList
              messageList.setAttribute("name", server.serverID);
              let badgeLoc = server.serverBadge;
              let serverName = document.getElementById("serverName");
              // serverName max text with badge: 202 px
              // serverName max text without badge: 235.6666717529297 px

              //when there is a badge, set the "left" css style attfribute to 35 px on the server name otherwise, set it to 40
              if (badgeLoc == "") {
                serverName.style.left = "20px";
              } else {
                serverName.style.left = "45px";
              }
              // make sure the text is not too long, do that by using the function getTextWidth
              let textWidth = getTextWidth(
                server.name,
                getCanvasFontSize(serverName)
              );
              // if the text is too long, make sure its less than the max width + 13.550000190734863 px and add "..." to the end of the text, the function return the width in px
              if (badgeLoc == "") {
                if (textWidth > 222.1166715621948) {
                  while (textWidth > 222.1166715621948) {
                    server.name = server.name.substring(
                      0,
                      server.name.length - 1
                    );
                    textWidth = getTextWidth(
                      server.name,
                      getCanvasFontSize(serverName)
                    );
                  }
                  server.name = server.name + "...";
                }
              } else {
                if (textWidth > 178.4499998092651) {
                  while (textWidth > 178.4499998092651) {
                    server.name = server.name.substring(
                      0,
                      server.name.length - 1
                    );
                    textWidth = getTextWidth(
                      server.name,
                      getCanvasFontSize(serverName)
                    );
                  }
                  server.name = server.name + "...";
                }
              }
              document.getElementById("serverArrow").style.visibility =
                "visible";
              document.getElementById("channel-list").style.visibility =
                "visible";
              serverName.innerText = server.name;
              if (badgeLoc == "") {
                document.getElementById("serverBadge").style.visibility =
                  "hidden";
              } else {
                document.getElementById("serverBadge").style.visibility =
                  "visible";
                document.getElementById("serverBadge").src = badgeLoc;
              }

              currentUser.focusedServer = server;
            }
            function sendMessage() {
              var message = document.getElementById("messageBox").value;
              if (message === "AW_DBG_HIDE") {
                document.getElementById("messageBox").value = "";
                if (
                  document.getElementById("main").classList.contains("hide")
                ) {
                  //remove it
                  document.getElementById("main").classList.remove("hide");
                } else {
                  //add it
                  document.getElementById("main").classList.add("hide");
                }
                return;
              }
              let code = Math.floor(new Date().getTime() * (Math.random() + 1));
              if (message != "") {
                socket.emit("sendMessage", {
                  message: escapeString(message),
                  sender: socket.id,
                  token: firebase?.auth()?.currentUser?.xa,
                  elementcode: code,
                  server: currentUser.focusedServer || "global",
                });
              }
              document.getElementById("messageList").innerHTML +=
                "<li id='temp-msg-" +
                code +
                "' class='pending'>" +
                "<img id='sender-pfp-" +
                code +
                "'>" +
                "<p id='usrname'><u><b>" +
                currentUser.name +
                "</b></u>" +
                "<br> " +
                escapeString(message) +
                "</p>" +
                "</li>";
              document.getElementById("messageList").innerHTML += "<br> ";
              document.getElementById("sender-pfp-" + code).src =
                currentUser.picture;
              document.getElementById("messageList").scrollTop =
                document.getElementById("messageList").scrollHeight;
              document.getElementById("messageBox").value = "";
            }
            document
              .getElementById("signout")
              .addEventListener("click", function () {
                firebase.auth().signOut();
              });

            window.document
              .getElementsByClassName("dropbtn")[0]
              .addEventListener("click", function () {
                if (
                  document.getElementById("dropdown-content").style.display ==
                  "block"
                ) {
                  document.getElementById("dropdown-content").style.display =
                    "none";
                } else {
                  document.getElementById("dropdown-content").style.display =
                    "block";
                }
              });

              //upon clicking on the "statusBtn" div, hide dropdown-content and show statusChange

            document
              .getElementById("statusBtn")
              .addEventListener("click", function () {
                document.getElementById("dropdown-content").style.display =
                  "none";
                document.getElementById("statusChange").style.display = "block";
              });
            //   document
            //   .getElementById("view-profile")
            //   .addEventListener("click", function (ev) {
            //     document.getElementById("user-menu").blur();
            //     socket.emit("getInfoProf", {
            //       token: firebase?.auth()?.currentUser?.xa,
            //       uid: ev?.currentTarget?.dataset?.uid,
            //     });
            //   });
            document
              .getElementById("statusOnline")
              .addEventListener("click", function () {
                if (currentUser.status !== "online") {
                  document.getElementById("statusChange").style.display =
                    "none";
                  socket.emit("changeStatus", {
                    status: "online",
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                }
              });

            document
              .getElementById("statusIdle")
              .addEventListener("click", function () {
                if (currentUser.status !== "idle") {
                  document.getElementById("statusChange").style.display =
                    "none";
                  socket.emit("changeStatus", {
                    status: "idle",
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                }
              });
            document
              .getElementById("statusDnd")
              .addEventListener("click", function () {
                if (currentUser.status !== "dnd") {
                  document.getElementById("statusChange").style.display =
                    "none";
                  socket.emit("changeStatus", {
                    status: "dnd",
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                }
              });

            document
              .getElementById("statusInvisible")
              .addEventListener("click", function () {
                if (currentUser.status !== "invisible") {
                  document.getElementById("statusChange").style.display =
                    "none";
                  socket.emit("changeStatus", {
                    status: "invisible",
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                }
              });
            document
              .getElementById("customStatus")
              .addEventListener("click", async function () {
                document.getElementById("statusChange").style.display = "none";
                let alertInfo = {
                  online: currentUser.status === "online" ? "selected" : "",
                  idle: currentUser.status === "idle" ? "selected" : "",
                  dnd: currentUser.status === "dnd" ? "selected" : "",
                  invisible:
                    currentUser.status === "invisible" ? "selected" : "",
                  custom: currentUser.statusText,
                };
                // use sweetalert to get custom status, get an selection type too
                const { value: formValues } = await Swal.fire({
                  //   title: "<h3 class='swal2-title' style='color:white'>" + "Custom Status" + "</h3>",
                  title: "Custom Status",
                  customClass: {
                    title: "whiteTextTitle",
                  },
                  background: "#292b30",
                  html:
                    '<input id="textStatus" class="customStatusInput" value="' +
                    alertInfo.custom +
                    '" placeholder="Support has arrived!">' +
                    '<select id="status" class="customStatusSelect"><option value="online" ' +
                    alertInfo.online +
                    '>Online</option><option value="idle" ' +
                    alertInfo.idle +
                    '>Idle</option><option value="dnd" ' +
                    alertInfo.dnd +
                    '>Do Not Disturb</option><option value="invisible" ' +
                    alertInfo.invisible +
                    ">Invisible</option></select>",
                  focusConfirm: false,
                  preConfirm: () => {
                    return [
                      document.getElementById("textStatus").value,
                      document.getElementById("status").value,
                    ];
                  },
                });
                if (formValues[1] == currentUser.status) {
                  socket.emit("changeStatus", {
                    customStatus: formValues[0],
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                } else {
                  socket.emit("changeStatus", {
                    customStatus: formValues[0],
                    status: formValues[1],
                    token: firebase?.auth()?.currentUser?.xa,
                  });
                }
                alertInfo = null;
              });
            document
              .getElementById("dropdown-content")
              .addEventListener("mouseleave", function () {
                document.getElementById("dropdown-content").style.display =
                  "none";
              });
            // do the same for statusChange
            document
              .getElementById("statusChange")
              .addEventListener("mouseleave", function () {
                document.getElementById("statusChange").style.display = "none";
              });

            document
              .getElementById("coverbg")
              .addEventListener("click", function () {
                for (let i of document.getElementsByName("profile-view")) {
                  console.log(i, " removed");
                  i.remove();
                }
                document.getElementById("coverbg").style.opacity = "0";
                document.getElementById("coverbg").style.visibility = "hidden";
                //opacity
              });
          }
        })();
      };
    </script>
    <div id="loading">
      <svg
        class="tea"
        width="57"
        height="68"
        viewbox="0 0 37 48"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M27.0819 17H3.02508C1.91076 17 1.01376 17.9059 1.0485 19.0197C1.15761 22.5177 1.49703 29.7374 2.5 34C4.07125 40.6778 7.18553 44.8868 8.44856 46.3845C8.79051 46.79 9.29799 47 9.82843 47H20.0218C20.639 47 21.2193 46.7159 21.5659 46.2052C22.6765 44.5687 25.2312 40.4282 27.5 34C28.9757 29.8188 29.084 22.4043 29.0441 18.9156C29.0319 17.8436 28.1539 17 27.0819 17Z"
          stroke="var(--secondary)"
          stroke-width="2"
        ></path>
        <path
          d="M29 23.5C29 23.5 34.5 20.5 35.5 25.4999C36.0986 28.4926 34.2033 31.5383 32 32.8713C29.4555 34.4108 28 34 28 34"
          stroke="var(--secondary)"
          stroke-width="2"
        ></path>
        <path
          id="teabag"
          fill="var(--secondary)"
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M16 25V17H14V25H12C10.3431 25 9 26.3431 9 28V34C9 35.6569 10.3431 37 12 37H18C19.6569 37 21 35.6569 21 34V28C21 26.3431 19.6569 25 18 25H16ZM11 28C11 27.4477 11.4477 27 12 27H18C18.5523 27 19 27.4477 19 28V34C19 34.5523 18.5523 35 18 35H12C11.4477 35 11 34.5523 11 34V28Z"
        ></path>
        <path
          id="steamL"
          d="M17 1C17 1 17 4.5 14 6.5C11 8.5 11 12 11 12"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke="var(--secondary)"
        ></path>
        <path
          id="steamR"
          d="M21 6C21 6 21 8.22727 19 9.5C17 10.7727 17 13 17 13"
          stroke="var(--secondary)"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </svg>
    </div>

    <div id="app">
      <div id="chat">
        <div id="messages">
          <ol id="messageList"></ol>
        </div>
        <div id="channelHeader">
          <!-- <div id="channelName"> -->
          <!-- <h4>#general</h4> -->
          <!-- </div> -->
        </div>
        <input
          type="text"
          placeholder="Message #global-chat"
          id="messageBox"
          class="css-input"
          autocapitalize="on"
          autocomplete="off"
        />
      </div>
      <div id="account">
        <div
          id="main"
          class="dropdown"
          style="position: relative; transition: left 0.75s ease; left: 0px"
        >
          <div
            id="server-left-div"
            style="
              overflow-x: hidden;
              overflow-y: scroll;
              scrollbar-width: none;
            "
          >
            <div id="mainSection" style="padding-top: 10px">
              <div
                id="home-btn"
                style="
                  position: absolute;
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  padding-top: 0px; /*! background-color: #2d2f31; */
                  height: 60px;
                  width: 60px;
                  padding-left: 5px;
                  padding-right: 5px;
                  border-radius: 50%;
                "
              >
                <div
                  id="homebtncover"
                  style="
                    background-color: #343638;
                    width: calc(100% - 15px);
                    position: absolute;
                    height: 100%;
                    border-radius: 50%; /*! padding-left: 5px; */ /*! padding-right: 5px; */
                    width: 60px;
                    transition: background-color 0.125s, border-radius 0.125s,
                      ease 0.125s;
                    z-index: 2;
                  "
                ></div>
                <img
                  style="
                    width: calc(100% - 20px);
                    height: calc(100% - 20px); /*! padding-top: 2px; */
                    z-index: 2;
                  "
                  src="/img/homebtn.png"
                  id="homebtnimg"
                />
              </div>
              <div
                style="
                  position: absolute;
                  background-color: #303134;
                  width: calc(100% - 40px);
                  height: 3px;
                  top: 80px;
                  padding-left: 2px;
                  padding-right: 2px;
                  display: flex;
                  border-radius: 10vh;
                  left: 50%;
                  transform: translateX(-50%);
                "
                id="server-left-line"
              ></div>
              <div
                id="mainServers"
                style="
                  width: 100%;
                  height: auto;
                  position: absolute;
                  margin-top: 80px;
                "
              ></div>
            </div>
          </div>
          <div id="server-div">
            <img
              id="serverBadge"
              style="width: 30px; left: 15px; position: relative"
            />
            <p
              id="serverName"
              style="
                color: white;
                font-weight: bolder;
                left: 35px;
                position: relative;
                transform: translateX(-10%);
                /*! margin-left: 60px; */
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                -webkit-box-flex: 1;
                -ms-flex: 1;
                flex: 1;
              "
            ></p>
            <img
              src="/img/arrow_down.svg"
              id="serverArrow"
              style="
                color: white;
                width: 25px;
                right: 20px;
                position: absolute;
                fill: white;
                visibility: hidden;
              "
            />
          </div>
          <div id="friend-list"></div>
          <div id="channel-list"></div>
          <div id="serverline"></div>
          <div id="profileSection">
            <div id="profile-img" class="dropbtn">
              <div id="transparentOutline"></div>
              <img id="userstatuspfp" />
            </div>
            <div id="profile-username"></div>
            <p
              id="profile-status"
              style="bottom: 0px; left: 62px"
              class="user-status"
            ></p>
          </div>
          <div id="dropdown-content">
            <a href="login.html">Account</a>
            <a href="#" id="statusBtn">Status <img id="userstatus" /></a>
            <a href="login.html">
              <div id="signout">Sign Out</div>
            </a>
          </div>
          <div id="statusChange">
            <a href="#" id="customStatus">Set a custom status</a>
            <a href="#" id="statusOnline"
              >Online <img src="/webchat-imgs/status_online.svg"
            /></a>
            <a href="#" id="statusIdle"
              >Idle <img src="/webchat-imgs/status_idle.svg"
            /></a>
            <a href="#" id="statusDnd"
              >Do not disturb <img src="/webchat-imgs/status_dnd.svg"
            /></a>
            <a href="#" id="statusInvisible"
              >Invisible <img src="/webchat-imgs/status_offline.svg"
            /></a>
          </div>
        </div>
      </div>
    </div>

    <style>
      .hide {
        left: -370px !important;
      }
      .srvpic {
        width: calc(100% - 5px);
        height: calc(100% - 5px);
        /* padding-top: 2px; */
        z-index: 2;
        border-radius: 10vh;
        transition: border-radius 0.25s, ease 0.25s;
      }
      .srvpic:hover {
        border-radius: 20px !important;
        cursor: pointer !important;
      }
      .pending {
        color: gray;
      }

      body {
        font-family: "Poppins", sans-serif;
        background-color: #2f3136;
      }

      #pfp {
        position: absolute;
        bottom: 10px;
        left: 12px;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        /* border: 2px solid #000;*/
      }

      img {
        /*no select*/
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      .changeonhover:hover {
        background-color: #33363c;
        cursor: pointer;
      }
      .changeonhover:hover .friend-status {
        color: #d3cfcf;
      }
      .changeonhover:hover .friend-name {
        color: #d3cfcf;
      }

      .customStatusInput {
        background: #303339;
        border: 1px solid #000;
        border-radius: 5px;
        color: #fff;
        padding: 12px;
        font-size: 16px;
        width: 63%;
      }

      /* on .customStatusInput: focus remove the focus border */
      .customStatusInput:focus {
        /* on focus turn the border to a solid blue */
        border: 1px solid #009ad7;
        outline: none;
        animation: border 0.5s forwards;
      }

      .customStatusSelect {
        margin: inherit;
        background: #303339;
        border: 1px solid #000;
        border-radius: 5px;
        color: #fff;
        padding: 12px;
        font-size: 16px;
        width: 69%;
        margin-right: 0px;
        margin-left: 0px;
      }
      [name="aboutmelink"],
      [name="aboutmelink"]:visited,
      [name="aboutmelink"]:hover,
      [name="aboutmelink"]:active {
        color: inherit;
      }

      /* .customStatusSelect when we hover over the values in the dropdown */

      .animated-gradient {
        animation: animateBg 14s linear infinite;
        background-image: linear-gradient(
          0deg,
          #110149,
          #000080,
          #1b7c46,
          #110149,
          #000080
        );
        background-size: 100% 400%;
      }

      @keyframes animateBg {
        0% {
          background-position: 0% 0%;
        }

        100% {
          background-position: 0% 100%;
        }
      }

      .selected {
        background-color: #383c41;
        color: white;
      }

      .whiteTextTitle {
        color: #cccccc;
      }

      .grayTextTitle {
        color: gray;
      }

      #pfp:hover {
        cursor: pointer;
        filter: brightness(0.8);
      }

      ::placeholder {
        /* Chrome, Firefox, Opera, Safari 10.1+ */
        color: #5e646e;
        opacity: 1;
        /* Firefox */
      }

      :-ms-input-placeholder {
        /* Internet Explorer 10-11 */
        color: #5e646e;
      }

      ::-ms-input-placeholder {
        /* Microsoft Edge */
        color: #5e646e;
      }

      #username {
        color: #dddddd;
        left: 62px;
        position: absolute;
        bottom: 27px;
        font-size: 15px;
      }

      #dropdown-content {
        display: none;
        position: fixed;
        background-color: #1a202c;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 5px;
        border-top-width: 10px;
        bottom: 60px;
        left: 80px;
      }

      #dropdown-content a {
        color: #fff;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        border-radius: 5px;
      }

      #dropdown-content a:hover {
        background-color: #12161f;
      }

      #friend-list {
        position: relative;
        background-color: #292b30;
        top: 41px;
        left: 60px;
        width: 303px;
        height: auto;
        overflow-y: scroll;
        overflow-x: hidden;
        -ms-overflow-style: none;
        scrollbar-width: none;
        min-height: calc(100vh - 49px);
      }

      #friend-list::-webkit-scrollbar {
        display: none;
      }

      #channel-list {
        visibility: hidden;
        position: absolute;
        background-color: #292b30;
        top: 41px;
        left: 60px;
        width: 303px;
        height: auto;
        overflow-y: scroll;
        overflow-x: hidden;
        -ms-overflow-style: none;
        scrollbar-width: none;
        min-height: calc(100vh - 49px);
        z-index: 3;
      }

      #channel-list::-webkit-scrollbar {
        display: none;
      }

      .user {
        background-color: #292b30;
        width: 301px;
        height: 50px;
        margin-bottom: 5px;
        align-content: center;
        align-items: center;
        display: flex;
        padding-left: 15px;
        position: relative;
        /* position: absolute; */
      }

      .friend-pfp {
        border-radius: 10vh;
        height: 40px;
        width: 40px;
        position: relative;
      }
      .server {
        border-radius: 10vh;
        display: flex;
        justify-content: center;
        width: 100%;
        height: 100%;
        align-items: center;
      }
      .server:hover {
        cursor: pointer;
      }
      .server:hover .server-image {
        border-radius: 14px !important;
      }
      .sidebar-selected {
        height: 30px !important;
      }
      .server-image {
        width: 48px;
        height: 48px;
        border-radius: 10vh;
        transition: border-radius 0.125s, ease 0.125s;
      }
      .server-sidebar {
        width: 4px;
        height: 4px;
        background-color: white;
        left: 2px;
        position: fixed;
        border-radius: 10vh;
        transition: height 0.125s, ease 0.125s;
      }

      .friend-name {
        position: absolute;
        font-weight: initial;
        color: #999999;
        z-index: 2;
      }

      .friend-status {
        position: absolute;
        font-size: 12px;
        font-weight: initial;
        color: gray;
        white-space: nowrap;
      }
      .user-status {
        position: absolute;
        font-size: 12px;
        font-weight: initial;
        color: gray;
        white-space: nowrap;
      }
      #server-div {
        position: absolute;
        background-color: #2f3136;
        top: -10px;
        left: 60px;
        width: 303px;
        height: 50px;
        z-index: 1;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #home-btn:hover #homebtncover {
        background-color: #5865f2 !important;
        border-radius: 17px !important;
      }
      #server-left-div {
        background-color: #202225;
        position: absolute;
        top: -8px;
        left: -10px;
        width: 70px;
        height: auto;
        z-index: 2;
        min-height: 100vh;
      }
      #serverline {
        position: absolute;
        top: 40px;
        width: 303px;
        left: 60px;
        height: 1px;
        background-color: #28292c;
      }

      #userstatuspfp {
        bottom: 10px;
        position: absolute;
        left: 32px;
        z-index: 1;
      }

      #transparentOutline {
        display: none;
        background-color: #292b2f;
        width: 12px;
        height: 12px;
        position: absolute;
        bottom: 10px;
        left: 38px;
        z-index: 1;
        border-radius: 10vh;
      }

      .transparentOutline {
        background-color: #292b2f;
        width: 12px;
        height: 12px;
        position: fixed;
        z-index: 1;
        border-radius: 10vh;
      }

      .status-pfp {
        z-index: 2;
      }

      .pfp-pic {
        border-radius: 10vh;
        height: 40px;
        width: 40px;
      }

      .css-input {
        padding: 6px;
        font-size: 17px;
        border-width: 0px;
        border-color: #292b2f;
        background-color: #40444b;
        color: #d9d9d9;
        border-style: solid;
        border-radius: 11px;
        box-shadow: 0px 0px 0px rgba(66, 66, 66, 0.75);
        text-shadow: 0px 0px 5px rgba(66, 66, 66, 0.75);
      }

      .css-input:focus {
        outline: none;
      }

      #statusChange {
        display: none;
        position: fixed;
        background-color: #1a202c;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 5px;
        border-top-width: 10px;
        bottom: 60px;
        left: 80px;
      }

      #statusChange a {
        color: #fff;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        border-radius: 5px;
      }

      #statusChange a:hover {
        background-color: #12161f;
      }

      #chat {
        /*middle responsive*/
        position: fixed;
        bottom: 0;
        left: 18.9rem;
        right: 0;
        height: 100%;
        background-color: #36393f;
      }

      #chat input {
        text-indent: 10px;
        /*middle center responsive*/
        position: absolute;
        width: 90%;
        bottom: 0;
        /* left: 0; */
        left: calc(50% + 35px);
        right: 25%;
        margin-left: -45%;
        margin-bottom: 10px;
        height: 30px;
      }

      #messages {
        position: fixed;

        top: 0;
        width: 100%;
        left: calc(18.9rem + 70px);

        height: calc(100% - 52px);
      }

      #messageList {
        overflow-x: hidden;
        white-space: normal;
        color: white;
        position: fixed;
        margin-top: 70px;
        height: calc(100% - 129px);
        width: 81.9%;
        overflow-wrap: anywhere;
      }

      #messageList li {
        display: flex;
        flex-direction: row;
      }

      #messageList li img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        justify-content: center;
        display: inline-flex;
        flex-direction: row;
        align-items: center;
        margin: 5px;
        margin-right: 13px;
      }

      #messageList li .timebox {
        color: transparent;
        /* make it so the user is unable to copy */
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        user-select: none;
      }

      #messageList li:hover {
        background: #32353b;
      }

      /* when li is hovered over .timebox should turn white */

      #messageList li:hover .timebox {
        color: #524f54;
      }

      #aftermsg {
        margin: 0px;
      }

      #messageList li .timebox {
        color: transparent;
        /* make it so the user is unable to copy */
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        user-select: none;
      }

      #messageList li:hover {
        background: #32353b;
      }

      /* when li is hovered over .timebox should turn white */

      #messageList li:hover .timebox {
        color: #524f54;
      }

      #aftermsg {
        margin: 0px;
      }

      #messageList li #usrname {
        top: 0;
        left: 0;
        margin: 0px;
        height: 25px;
        display: inline-table;
      }

      #messageList li #text {
        margin-top: 21px;
        margin-bottom: 0px;
        margin-right: 0px;
        position: relative;
        left: -60px;
      }

      #channelHeader {
        position: fixed;
        display: flex;
        top: -10px;
        width: 100%;
        left: calc(18.3rem + 70px);
        height: 48px;
        background-color: #36393f;
        color: white;
        font-size: 1.2rem;
        font-weight: bold;
        padding-left: 10px;
        padding-top: 10px;
        border-bottom: 1px solid #28292c;
      }

      #profileSection {
        background-color: #292b2f;
        position: absolute;
        bottom: -40px;
        left: 62px;
        width: 301px;
        height: 60px;
        z-index: 2;
      }

      @media screen and (max-width: 768px) {
      }

      @media screen and (max-width: 576px) {
      }

      @media screen and (max-width: 425px) {
      }
    </style>
  </body>
</html>

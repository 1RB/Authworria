<!DOCTYPE html>
<html lang="en">
  
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://kit.fontawesome.com/1788c719dd.js" crossorigin="anonymous"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase-app.js"></script>-->
    <!-- <script src="https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.js"></script>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap"
  rel="stylesheet" />
  <link rel="stylesheet" href="./css/signup.css" />
  <title>Log in</title>
</head>
<!-- did you uncomment the index? yeah i didnt initialize the app yeah its commented under index.html-->
<!-- Uncaught FirebaseError: Firebase: No Firebase App '[DEFAULT]' has been created - call Firebase App.initializeApp() (app/no-app). -->

<body>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-app.js";
    (async () => {
      // import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-analytics.js";
      
      const firebaseConfig = {
        apiKey: "AIzaSyBXksQoBsWZkS8Dw_P90mb9BP-wt9XaMrg", //<- lemfao
        authDomain: "authworria.firebaseapp.com",
        databaseURL:
        "https://authworria-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "authworria",
        storageBucket: "authworria.appspot.com",
        messagingSenderId: "635623599897",
        appId: "1:635623599897:web:0ee18f2824aa3b764e5f88",
        measurementId: "G-P84R1SCWJB",
      };

      const app = await firebase.initializeApp(firebaseConfig); // <- bruh this isnt working
      
      console.log(app);
      console.log(firebase.app()); // yup ik thank me later
      // const analytics = getAnalytics(app);
      
      document
      .getElementById("googlesignin")
        .addEventListener("click", GoogleLogin);
        
      document
      .getElementById("googlesignup")
      .addEventListener("click", GoogleLogin);
      
      document.getElementById("signout").addEventListener("click", GoogleLogout);
      
      function GoogleLogin() {
        var provider = new firebase.auth.GoogleAuthProvider();
        firebase
          .auth()
          .signInWithPopup(provider)
          .then(res => {
            console.log(res.user);
            document.getElementById("dashboard").style.display = "block";
            document.getElementById("loginscreen").style.display = "none";
            showUserDetails(res.user);
          }).catch(e => {
            console.log(e);
          });
        }

        function showUserDetails(user) {
          document.getElementById("userid").innerHTML = `
              <img src="${user.photoURL}"style="width:100px;height:100px;border-radius:50%;">
                <h2>${user.displayName}</h2>
                <p>${user.email}</p>
            `;
      
          }
          
          
          function isUserSignedIn(){
            firebase.auth().onAuthStateChanged(user => {
              if (user) {
                document.getElementById('loginscreen').style.display = "none"
                document.getElementById('dashboard').style.display = "block"
                showUserDetails(user)
              } else {
    
              }
            })
          }

      function GoogleLogout() {
        firebase
        .auth()
        .signOut()
        .then(function () {
            // Sign-out successful.
            document.getElementById("dashboard").style.display = "none";
            document.getElementById("loginscreen").style.display = "block";
          })
          .catch(function (error) {
            // An error happened.
          });
      }

      document
        .getElementById("dashboard").style.display = "none";

      document
        .getElementById("githubsignin")
        .addEventListener("click", GithubLogin);
      
      function GithubLogin() {
        const provider = new firebase.auth.GithubAuthProvider();
        firebase
          .auth()
          .signInWithPopup(provider)
          .then((result) => {
            // This gives you a GitHub Access Token. You can use it to access the GitHub API.
            var token = result.credential.accessToken;
            // The signed-in user info.
            var user = result.user;
            console.log(user, token);
          })
          .catch((error) => {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            console.log(errorCode, errorMessage);
          });
      }



      


        isUserSignedIn();
        // function (result) {
          // var token = result.credential.accessToken;
          // var user = result.user;
          // console.log("Your token is: %s, User:", token, user);
        // }); 
      
    })();

      // var provider = new firebase.auth.GoogleAuthProvider();
      // firebase.auth().signInWithPopup(provider).then(function (result) {
      //     var token = result.credential.accessToken;
      //     var user = result.user;
      // }).catch(function (error) {
      //     var errorCode = error.code;
      //     var errorMessage = error.message;
      //     var email = error.email;
      //     var credential = error.credential;
      // });
      // }

      //why is this inside the onclick function
  </script>
  <div id="loginscreen">
    <div class="container">
      <div class="container__forms">
        <div class="form">
          <form action="" class="form__sign-in">
            <h2 class="form__title">Sign In</h2>
            <div class="form__input-field">
              <i class="fas fa-user"></i>
              <input id="signinusername" type="text" placeholder="Username" required />
            </div>
            <div class="form__input-field">
              <i class="fas fa-lock"></i>
              <input id="signinpassword" type="password" placeholder="Password" required />
            </div>
            <input class="form__submit" type="submit" value="Login" />
            <p class="form__social-text">Or Sign in with your social media</p>
            <div class="form__social-media">
              <a href="#" class="form__social-icons">
                <i class="fab fa-firefox"></i>
              </a>
              <a href="#" class="form__social-icons">
                <i class="fab fa-twitter"></i>
              </a>
              <a id="googlesignin" class="form__social-icons">
                <i class="fab fa-google"></i>
              </a>
              <a id="githubsignin" href="#" class="form__social-icons">
                <i class="fab fa-github"></i>
              </a>
            </div>
          </form>

          <form action="" class="form__sign-up">
            <h2 class="form__title">Sign Up</h2>
            <div class="form__input-field">
              <i class="fas fa-user"></i>
              <input type="text" placeholder="Username" required />
            </div>
            <div class="form__input-field">
              <i class="fas fa-envelope"></i>
              <input type="text" placeholder="Email" required />
            </div>
            <div class="form__input-field">
              <i class="fas fa-lock"></i>
              <input type="password" placeholder="Password" required />
            </div>

            <input class="form__submit" type="submit" value="Sign Up" />

            <p class="form__social-text">Or Sign Up with your social media</p>
            <div class="form__social-media">
              <a href="#" class="form__social-icons">
                <i class="fab fa-apple"></i>
              </a>
              <a href="#" class="form__social-icons">
                <i class="fab fa-twitter"></i>
              </a>
              <a id="googlesignup" class="form__social-icons">
                <i class="fab fa-google"></i>
              </a>
              <a href="#" class="form__social-icons">
                <i class="fab fa-github"></i>
              </a>
            </div>
          </form>
        </div>
      </div>
      <div class="container__panels">
        <div class="panel panel__left">
          <div class="panel__content">
            <h3 class="panel__title">Are You New Here?</h3>
            <p class="panel__paragraph">
              Let's get you signed up. It's free and takes less than a minute.
            </p>
            <button class="btn btn-transparent" id="sign-up-btn">
              Sign Up
            </button>
          </div>
          <img class="panel__image"
            src="https://media.discordapp.net/attachments/886383437303402496/904105072470949948/unknown.png" alt="" />
        </div>
        <div class="panel panel__right">
          <div class="panel__content">
            <h3 class="panel__title">Do you already have an account?</h3>
            <p class="panel__paragraph">
              Log in to your account to get started.
            </p>
            <button class="btn btn-transparent" id="sign-in-btn">
              Sign In
            </button>
          </div>
          <img class="panel__image"
            src="https://media.discordapp.net/attachments/886383437303402496/904104234931335198/unknown.png" alt="" />
        </div>
      </div>
    </div>
  </div>

  <div id="dashboard">
    <div id="userid">
      <h1>Welcome</h1>
    </div>
    <button id="signout">Sign Out</button>
    <style>
      .signout {
        background-color: #ff0000;
        color: white;
        border: none;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
      }
    </style>
  </div>

  <script src="./js/signup.js"></script>
  <script src="./js/app.js"></script>
</body>

</html>